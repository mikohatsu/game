<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Instrument Panel</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <style>
        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none;
            height: 16px; width: 16px;
            border-radius: 50%; background: currentColor;
            cursor: pointer; margin-top: -4px;
        }
        /* ë“œë˜ê·¸ ì¤‘ í…ìŠ¤íŠ¸ ì„ íƒ ë°©ì§€ */
        .no-select { user-select: none; -webkit-user-select: none; }
    </style>
</head>
<body class="bg-slate-100">

    <div id="root"></div>

    <script type="text/babel">
        const { useState, useRef, useEffect } = React;

        // ğŸŒ¡ï¸ ì˜¨ë„ê³„ (ê¸°ì¡´ê³¼ ë™ì¼)
        const Thermometer = ({ value }) => {
            const min = -10, max = 60;
            const percentage = Math.min(Math.max(((value - min) / (max - min)) * 100, 0), 100);

            return (
                <div className="flex flex-col items-center gap-4 no-select">
                    <div className="relative w-16 h-80 bg-gray-200 rounded-full border-4 border-gray-300 shadow-xl p-1 box-border">
                        <div className="absolute inset-0 rounded-full bg-gradient-to-r from-transparent via-white/30 to-transparent z-20 pointer-events-none"></div>
                        <div className="absolute right-2 top-4 bottom-16 flex flex-col justify-between text-[10px] text-gray-400 font-mono z-0">
                            <span>{max}Â°</span><span>â€¢</span><span>â€¢</span><span>â€¢</span><span>{min}Â°</span>
                        </div>
                        <div className="w-full h-[calc(100%-3rem)] bg-gray-100 rounded-t-full relative mx-auto overflow-hidden">
                            <div className="absolute bottom-0 w-full bg-red-500 transition-all duration-300 ease-out shadow-[0_0_10px_rgba(239,68,68,0.6)]" style={{ height: `${percentage}%` }}>
                                <div className="w-full h-1 bg-white/40"></div>
                            </div>
                        </div>
                        <div className="absolute bottom-1 left-1/2 -translate-x-1/2 w-12 h-12 bg-red-500 rounded-full shadow-inner border-4 border-gray-100 z-10 flex items-center justify-center">
                            <div className="w-4 h-4 bg-white/30 rounded-full blur-[2px] absolute top-2 left-2"></div>
                        </div>
                    </div>
                    <div className="text-center">
                        <span className="text-xl font-bold text-gray-700">{value}Â°C</span>
                    </div>
                </div>
            );
        };

        // â±ï¸ ì¸í„°ë™í‹°ë¸Œ ì••ë ¥ê³„ (ìˆ˜ì •ë¨)
        const PressureGauge = ({ value, onChange }) => {
            const gaugeRef = useRef(null);
            const [isDragging, setIsDragging] = useState(false);

            // ê°ë„ ê³„ì‚° ìƒìˆ˜
            const MIN_ANGLE = -120; // 8ì‹œ ë°©í–¥
            const MAX_ANGLE = 120;  // 4ì‹œ ë°©í–¥
            const ANGLE_RANGE = MAX_ANGLE - MIN_ANGLE;

            // ê°’ -> ê°ë„ ë³€í™˜
            const currentAngle = MIN_ANGLE + ((value / 100) * ANGLE_RANGE);

            // ë§ˆìš°ìŠ¤/í„°ì¹˜ ì¢Œí‘œë¥¼ ê°’(0~100)ìœ¼ë¡œ ë³€í™˜í•˜ëŠ” í•¨ìˆ˜
            const calculateValueFromEvent = (e) => {
                if (!gaugeRef.current) return;
                
                const rect = gaugeRef.current.getBoundingClientRect();
                const centerX = rect.left + rect.width / 2;
                const centerY = rect.top + rect.height / 2;
                
                // ë§ˆìš°ìŠ¤/í„°ì¹˜ ìœ„ì¹˜ ì²˜ë¦¬
                const clientX = e.touches ? e.touches[0].clientX : e.clientX;
                const clientY = e.touches ? e.touches[0].clientY : e.clientY;

                // atan2ë¡œ ê°ë„ ê³„ì‚° (ë¼ë””ì•ˆ -> ë„)
                // -90ë„ë¥¼ í•´ì£¼ëŠ” ì´ìœ ëŠ” atan2ì˜ 0ë„ê°€ 3ì‹œ ë°©í–¥ì´ê¸° ë•Œë¬¸ (ìš°ë¦¬ëŠ” 12ì‹œ ê¸°ì¤€ ë³´ì •)
                let angle = Math.atan2(clientY - centerY, clientX - centerX) * (180 / Math.PI) + 90;

                // ê°ë„ ë³´ì • (atan2ì˜ ê²°ê³¼ê°’ ì í”„ êµ¬ê°„ ë³´ì •)
                if (angle > 180) angle -= 360; 

                // ì œí•œ ë²”ìœ„ ë‚´ë¡œ í´ë¨í•‘ (ë°”ëŠ˜ì´ íœ™ ëŒì•„ê°€ì§€ ì•Šê²Œ)
                // í•˜ë‹¨ ë¹ˆ ê³µê°„(ëŒ€ëµ 130ë„ ~ -130ë„ ì‚¬ì´ì˜ ì•„ë˜ìª½)ì— ë§ˆìš°ìŠ¤ê°€ ìˆìœ¼ë©´ ë¬´ì‹œí•˜ê±°ë‚˜ ê°€ê¹Œìš´ ìª½ìœ¼ë¡œ ë¶™ì„
                if (angle < MIN_ANGLE) angle = MIN_ANGLE;
                if (angle > MAX_ANGLE) angle = MAX_ANGLE;

                // ê°ë„ë¥¼ 0~100 ê°’ìœ¼ë¡œ ì—­ì‚°
                const newValue = Math.round(((angle - MIN_ANGLE) / ANGLE_RANGE) * 100);
                
                // 0ê³¼ 100 ì‚¬ì´ë¡œ ì•ˆì „í•˜ê²Œ ìë¦„
                const clampedValue = Math.min(Math.max(newValue, 0), 100);
                
                onChange(clampedValue);
            };

            const handleMouseDown = (e) => {
                setIsDragging(true);
                calculateValueFromEvent(e);
            };

            useEffect(() => {
                const handleMouseMove = (e) => {
                    if (isDragging) {
                        calculateValueFromEvent(e);
                    }
                };
                const handleMouseUp = () => setIsDragging(false);

                if (isDragging) {
                    window.addEventListener('mousemove', handleMouseMove);
                    window.addEventListener('mouseup', handleMouseUp);
                    window.addEventListener('touchmove', handleMouseMove);
                    window.addEventListener('touchend', handleMouseUp);
                }

                return () => {
                    window.removeEventListener('mousemove', handleMouseMove);
                    window.removeEventListener('mouseup', handleMouseUp);
                    window.removeEventListener('touchmove', handleMouseMove);
                    window.removeEventListener('touchend', handleMouseUp);
                };
            }, [isDragging]);


            return (
                <div className="flex flex-col items-center gap-4 no-select">
                    {/* ê²Œì´ì§€ ì „ì²´ ì»¨í…Œì´ë„ˆ + ë§ˆìš°ìŠ¤ ì´ë²¤íŠ¸ */}
                    <div 
                        ref={gaugeRef}
                        onMouseDown={handleMouseDown}
                        onTouchStart={handleMouseDown}
                        className="relative w-64 h-64 rounded-full bg-gradient-to-br from-gray-200 to-gray-400 p-2 shadow-2xl border border-gray-500 cursor-pointer active:scale-105 transition-transform"
                        title="Drag to change pressure"
                    >
                        <div className="w-full h-full rounded-full bg-white relative shadow-inner flex items-center justify-center overflow-hidden">
                            
                            {/* ëˆˆê¸ˆ */}
                            {[0, 10, 20, 30, 40, 50, 60, 70, 80, 90, 100].map((tick, i) => {
                                const tickAngle = -120 + (i * 24);
                                return (
                                    <div 
                                        key={i}
                                        className="absolute w-full h-full text-center"
                                        style={{ transform: `rotate(${tickAngle}deg)` }}
                                    >
                                        <div className="mx-auto w-[2px] h-3 bg-gray-400 mt-2"></div>
                                        {tick % 20 === 0 && (
                                            <span className="block mt-1 text-xs font-bold text-gray-500" style={{ transform: `rotate(${-tickAngle}deg)` }}>
                                                {tick}
                                            </span>
                                        )}
                                    </div>
                                )
                            })}

                            {/* ìƒ‰ìƒ ë  (Conic Gradient ìˆ˜ì •ë¨) */}
                            {/* CSS conic-gradientëŠ” 12ì‹œ(0deg) ê¸°ì¤€ ì‹œê³„ë°©í–¥. 
                                ìš°ë¦¬ ê²Œì´ì§€ëŠ” -120ë„(8ì‹œ) ì‹œì‘ -> +120ë„(4ì‹œ) ë. ì´ 240ë„.
                                ì´ˆë¡(0~60%), ë…¸ë‘(60~80%), ë¹¨ê°•(80~100%)
                                ì‹œì‘ì  ì¡°ì •(from 240deg)ë¡œ 8ì‹œ ë°©í–¥ì„ 0ìœ¼ë¡œ ë§ì¶¤
                            */}
                            <div 
                                className="absolute inset-5 rounded-full opacity-20 pointer-events-none"
                                style={{
                                    background: `conic-gradient(from 240deg, 
                                        lime 0deg, 
                                        lime 144deg, 
                                        yellow 144deg, 
                                        yellow 192deg, 
                                        red 192deg, 
                                        red 240deg, 
                                        transparent 240deg)`
                                }}
                            ></div>
                            {/* ë‚´ë¶€ ì› ê°€ë¦¬ê°œ (ë„ë„› ëª¨ì–‘ ë§Œë“¤ê¸°) */}
                            <div className="absolute inset-10 bg-white rounded-full shadow-sm z-0"></div>

                            {/* ì¤‘ì•™ í…ìŠ¤íŠ¸ */}
                            <div className="absolute top-2/3 text-center z-10 pointer-events-none">
                                <span className={`text-2xl font-bold font-mono ${value > 80 ? 'text-red-600 animate-pulse' : 'text-slate-800'}`}>
                                    {value}
                                </span>
                                <span className="text-xs block text-slate-500">PSI</span>
                            </div>

                            {/* ğŸ“Œ ë°”ëŠ˜ (ìœ„ì¹˜ ë° íšŒì „ì¶• êµì •ë¨) */}
                            <div 
                                className="absolute z-20 pointer-events-none"
                                style={{
                                    // ì¤‘ì•™ ì •ë ¬ì„ ìœ„í•œ í•µì‹¬:
                                    top: '50%', left: '50%',
                                    width: '4px', height: '45%', // ë°”ëŠ˜ ê¸¸ì´ (ë°˜ì§€ë¦„ì˜ 90% ì •ë„)
                                    backgroundColor: '#DC2626',
                                    borderRadius: '4px 4px 0 0',
                                    // íšŒì „ì¶•ì„ ë°”ëŠ˜ì˜ 'ë§¨ ì•„ë˜ìª½(bottom)'ìœ¼ë¡œ ì„¤ì •
                                    transformOrigin: 'bottom center', 
                                    // ì´ˆê¸° ìœ„ì¹˜: ë°”ëŠ˜ ì•„ë˜ìª½ì´ ì›ì (50%,50%)ì— ì˜¤ë„ë¡ ìœ„ë¡œ ì´ë™(-100%) + ì™¼ìª½ìœ¼ë¡œ ì´ë™(-50%)
                                    // ê·¸ë¦¬ê³  íšŒì „ ì ìš©
                                    transform: `translate(-50%, -100%) rotate(${currentAngle}deg)`,
                                    transition: isDragging ? 'none' : 'transform 0.1s ease-out'
                                }}
                            ></div>
                            
                            {/* ë°”ëŠ˜ ìº¡ (ì¤‘ì•™ ì›) */}
                            <div className="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-4 h-4 bg-gray-800 rounded-full border-2 border-gray-300 z-30 shadow-md pointer-events-none"></div>
                        </div>
                    </div>
                    <div className="text-center">
                        <span className="text-xl font-bold text-gray-700">{value} PSI</span>
                    </div>
                </div>
            );
        };

        const App = () => {
            const [temp, setTemp] = useState(24);
            const [pressure, setPressure] = useState(45);

            return (
                <div className="min-h-screen flex flex-col items-center justify-center p-8 font-sans bg-slate-100 select-none">
                    <h1 className="text-3xl font-bold text-slate-700 mb-12">Control Panel</h1>

                    <div className="flex flex-wrap gap-16 items-end justify-center mb-16 p-8 bg-white rounded-3xl shadow-xl border border-slate-200">
                        <Thermometer value={temp} />
                        {/* ì••ë ¥ê³„ì— onChange í•¸ë“¤ëŸ¬ ì „ë‹¬ */}
                        <PressureGauge value={pressure} onChange={setPressure} />
                    </div>

                    <div className="w-full max-w-lg bg-white p-6 rounded-xl shadow-lg border border-slate-200">
                        <h3 className="text-lg font-semibold text-slate-600 mb-4 border-b pb-2">Manual Sliders</h3>
                        <div className="mb-6">
                            <div className="flex justify-between mb-2">
                                <label className="text-sm font-medium text-slate-600">Temperature</label>
                                <span className="text-sm font-bold text-red-500">{temp}Â°C</span>
                            </div>
                            <input type="range" min="-10" max="60" value={temp} onChange={(e) => setTemp(Number(e.target.value))} className="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer text-red-500" />
                        </div>
                        <div>
                            <div className="flex justify-between mb-2">
                                <label className="text-sm font-medium text-slate-600">Pressure</label>
                                <span className="text-sm font-bold text-blue-600">{pressure} PSI</span>
                            </div>
                            <input type="range" min="0" max="100" value={pressure} onChange={(e) => setPressure(Number(e.target.value))} className="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer text-blue-600" />
                        </div>
                    </div>
                    <p className="text-slate-400 mt-8 text-sm">ğŸ’¡ Tip: You can now drag the Pressure Gauge needle directly!</p>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
